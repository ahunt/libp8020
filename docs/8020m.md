# 8020Mgen2 a.k.a. M41A1 PATS

The device has both an RJ46 and USB-B ports:

* The RJ46 is labelled as "RS-232", and appears to behave approximately the same
  as on an 8020Mgen1, further details below.
* The USB-B port connects to a built-in FT232 (details below), but I have been
  unable to make it work so far (`picocom -c --baud 1200 /dev/ttyUSB0` -> `J` ->
  no response.)
* The manual states that the device should be in "System Check" mode when
  connecting, but I haven't had any issues connecting from "Fit Test" and "Real
  Time" modes as long as no test is running.
* Flow control is not supported - the device simply won't respond / ignores your
  inputs (similar to older 8020's). (Picocom flag `-fh.)

## Protocol notes

* `S` ("Request Settings") is not supported - response: `S ERR`.
* `BNN` ("Beep NN deciseconds") actually appears to trigger a beep with the
  correct duration (on older devices the beep stops as soon as the next command
  arrives), but... the device might restart after the beep. This behaviour
  appears to depend on the length of the requested beep - 40 deciseconds always
  triggers a restart, 4 deciseconds does not, and the range in between needs
  more testing.

## USB device details

```
$ lsusb -v
Bus 003 Device 050: ID 0403:6001 Future Technology Devices International, Ltd FT232 Serial (UART) IC
Couldn't open device, some information will be missing
Negotiated speed: Full Speed (12Mbps)
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 [unknown]
  bDeviceSubClass         0 [unknown]
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0403 Future Technology Devices International, Ltd
  idProduct          0x6001 FT232 Serial (UART) IC
  bcdDevice            6.00
  iManufacturer           1 FTDI
  iProduct                2 FT232R USB UART
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength       0x0020
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xa0
      (Bus Powered)
      Remote Wakeup
    MaxPower               90mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              2 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
```
